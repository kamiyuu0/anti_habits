<%= form_with model: anti_habit, local: true, class: "space-y-6" do |form| %>
  <!-- エラーメッセージ -->
  <% if anti_habit.errors.any? %>
    <div class="alert alert-error">
      <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div>
        <h3 class="font-bold">入力内容を確認してください</h3>
        <div>
          <% anti_habit.errors.full_messages.each do |message| %>
            <div><%= message %></div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <!-- タイトル -->
  <div class="form-control">
    <div class="label">
      <span class="label-text font-semibold">悪習慣のタイトル</span>
    </div>
    <%= form.text_field :title,
        class: "input input-bordered w-full",
        placeholder: "例：休日の前日につい夜更かししてしまう",
        maxlength: 20 %>
  </div>

  <!-- 説明 -->
  <div class="form-control">
    <div class="label">
      <span class="label-text font-semibold">詳細説明</span>
    </div>
    <%= form.text_area :description,
        rows: 5,
        class: "textarea textarea-bordered w-full",
        placeholder: "例:YouTubeやSNSを見てしまい深夜まで起きている。翌日の仕事に支障が出ている。",
        maxlength: 80 %>
  </div>

  <!-- タグ -->
  <div class="form-control"
       data-controller="tagify"
       data-tagify-tags-url-value="<%= tags_path %>"
       data-tagify-initial-value-value="<%= anti_habit.tag_names %>">
    <div class="label">
      <span class="label-text font-semibold">タグ</span>
    </div>
    <%= form.text_field :tag_names,
        class: "input input-bordered w-full",
        placeholder: "例：夜更かし, スマホ依存, SNS",
        value: anti_habit.tag_names %>
  </div>

  <!-- 目標達成日数 -->
  <div class="form-control">
    <div class="label">
      <span class="label-text font-semibold">目標達成日数（任意）</span>
      <div class="badge badge-soft badge-xs tooltip", data-tip="目標日数を設定すると、達成時に達成感を得られます（1〜365日）。
設定しなくても記録は続けられます。">
        ?
      </div>
    </div>
    <%= form.number_field :goal_days,
        class: "input input-bordered w-full",
        placeholder: "例：30",
        min: 1,
        max: 365 %>
  </div>

  <!-- 公開設定 -->
  <div class="form-control">
    <label class="label cursor-pointer justify-start gap-4">
      <%= form.check_box :is_public, class: "checkbox checkbox-primary" %>
      <span class="label-text font-semibold">この悪習慣を公開する</span>
    </label>
  </div>

  <!-- 送信ボタン -->
  <div class="form-control">
    <div class="flex flex-col sm:flex-row gap-3">
      <%= form.submit anti_habit.persisted? ? "更新する" : "登録する", 
          class: "btn btn-primary flex-1" %>
      <%= link_to "キャンセル", anti_habit.persisted? ? anti_habit_path(anti_habit) : anti_habits_path, 
          class: "btn btn-outline flex-1" %>
    </div>
  </div>
<% end %>
